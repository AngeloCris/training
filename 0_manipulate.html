<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Manipulando, analizando y exportando datos con tidyverse</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="docs/css/swcarpentry-lessons.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="01_index.html">
    <span class="fas fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-graduation-cap"></span>
     
    Lecturas
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Generalidades</li>
    <li>
      <a href="https://docs.google.com/presentation/d/18t4PEkoztvN1Nbb2-xFD0tB7jWSDSNaDxj__AEK5Zpk/edit#slide=id.g1cbe8ff695a_0_10">1. Software R project y R-studio</a>
    </li>
    <li>
      <a href="https://docs.google.com/presentation/d/1X_tnJ4eO7aajQBV7OqiPtZBxVmt5UgBjQstvRXOVTJ8/edit">2. Tipos de datos en R: Vectores</a>
    </li>
    <li>
      <a href="https://docs.google.com/presentation/d/1Gwl5ROqqDCbVZsX1OCI5ifciMqwzCf1rO5f0l5YBvhQ/edit#slide=id.p">3. Tipos de datos en R: Matrices, listas y dataframes</a>
    </li>
    <li>
      <a href="https://docs.google.com/presentation/d/1xTdOQDf7LELOEe1XmYUdkHY3YUcq7hm0NWA1OXKg9N0/edit">4. Operadores</a>
    </li>
    <li class="dropdown-header">Análisis de datos</li>
    <li>
      <a href="https://docs.google.com/presentation/d/1DDRcBjj4oxutC2vHsRqBR9O7VYbiKCzgI134r2YMKQw/edit#slide=id.p">5. Manipulación de datos: Importación</a>
    </li>
    <li>
      <a href="https://docs.google.com/presentation/d/1SLQ3dVqzQhgO1rykYdGOzleDqou6fbOb6mZY79FPc2Q/edit#slide=id.p">6. Manipulación de datos: Tidy data</a>
    </li>
    <li>
      <a href="https://docs.google.com/presentation/d/1df1qQG5ZLuo_lRNakqnMX_o6pxDs3r8NYRrbOKLTnfI/edit#slide=id.p">7. Manipulación de datos: Transformación</a>
    </li>
    <li>
      <a href="https://docs.google.com/presentation/d/1dPCaZuV1LL6AoDX_5wssz2KZnsvlQlqGISGnzN6ulxE/edit#slide=id.p">8. Visualización de datos</a>
    </li>
    <li class="dropdown-header">Documentación</li>
    <li>
      <a href="https://docs.google.com/presentation/d/1XNn-AMjTeeHTNERRyuf-xcgt1RDu0GdADWzjFKJ7Geg/edit#slide=id.p">9. Reportes en R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-graduation-cap"></span>
     
    Caso Estudio
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="04_casoPractico01.html">1. Casos de estudio I</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="00_setup.html">
    <span class="fas fa-cogs"></span>
     
    Setup
  </a>
</li>
<li>
  <a href="https://github.com/AngeloCris/training">
    <span class="fab fa-github"></span>
     
    Repo
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<body>
    <p style="height: 50px;">
        <img src="tnc_logo-removebg-preview.png" alt="Right Logo"
          title="Right Logo" style="height: 50px;  margin-top: 10px; float: right; margin-right: 0.5%;">
    </p>
</body>


<div id="header">



<h1 class="title toc-ignore">Manipulando, analizando y exportando datos
con tidyverse</h1>

</div>


<p>La forma de manipulación de datos usando base R puede resultar
complicado y difícil de entender, especialmente para procesos complejos.
Como una alternativa a ello se han desarrollado diferentes paqueterías
que ayuda a manipular, depurar y visualizar datos. Todas estas
paqueterías estan englobadas en una sola conocida como
<code>tidyverse</code>. Este universo incluye paqueterías como
<code>dplyr</code>, <code>tidyr</code>, <code>readr</code> y
<code>ggplo2</code>. <code>tidyr</code> y <code>dplyr</code> resultan
muy útiles para manipular datos, <code>readr</code> es genial para
importar datos como archivos <code>csv</code>, mientras que
<code>ggplot2</code> es uno de los mejores paquetes para la
vizualización de datos. <code>lubridate</code> es otro paquete muy útil
cuando se trabaja con fechas y horas. Aprenda más de la colección de
paquetes que conforman el universo <code>tidyverse</code> <a
href="https://www.tidyverse.org/">here</a>.</p>
<div id="objetivo" class="section level2 unnumbered objectives">
<h2 class="unnumbered objectives">Objetivo</h2>
<ul>
<li><p>Describir los propósitos de las librerías dplyr y tidyr.</p></li>
<li><p>Seleccionar columnas específicas de una base de datos usando la
función <code>select()</code> de dplyr.</p></li>
<li><p>Extraer filas de una base de datos de acuerdo a condiciones
lógicas usando la función <code>filter()</code> de dplyr.</p></li>
<li><p>Aprender a usar el operador pipeline <code>%&gt;%</code></p></li>
<li><p>Añadir nuevas columnas a una base de datos usando la función
<code>mutate()</code> de dplyr.</p></li>
<li><p>Utilizar la función <code>group_by()</code> y
<code>count()</code> para dividir una base de datos en grupos de
observaciones y aplicar estadísticos descriptivos a los mismos.</p></li>
<li><p>Describir el concepto de formato de tabla largo y ancho de una
base de datos y para qué son útiles estos formatos.</p></li>
<li><p>Reestructurar una base de datos en formaro largo y ancho
empleando las funciones <code>pivot_longer()</code> y
<code>pivot_wider()</code> de tidyr.</p></li>
<li><p>Exportar un marco de datos a un archivo .csv.</p></li>
</ul>
<!-- El universo `tidyverse` trata de resolver 3 problemas comunes que surgen al realizar análisis de datos en R -->
<!-- 1. Los resultados de una función base de R depende del tipo de datos. -->
<!-- 2. Las expresiones utilizadas en R no tienen un formato estandar, lo que puede resultar confuso para los nuevos alumnos. -->
<!-- 3. La existencia de argumentos ocultos con operaciones por defectos que los nuevos alumnos desconocen. -->
<!-- Para instalar este paquete se debe escribir directamente en la consola el siguiente argumento `install.package("tidyverse")". -->
</div>
<div id="dplyr---tidyr" class="section level2">
<h2>Dplyr - Tidyr</h2>
<p>El paquete <code>dplyr</code> fue construido para trabajar
directamente con bases de datos. Proporciona herramientas útiles para
las tareas más comunes de manipulación de datos (seleccionar, filtrar,
agregar columnsa, agrupar observaciones). El paquete <code>tidyr</code>
aborda la necesidad de reestructurar y reordenar datos para
visualizarlos o utilizarlos con diferentes funciones de R. Para conocer
las principales funciones de las librerías <code>dplyr</code> y
<code>tidyr</code> puedes consultar <a
href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-transformation.pdf">este
fichero resumen</a>.</p>
<p>Antes de comenzar asegurémonos de tener instalado los siguientes
paquetes: <code>tidyverse</code> y <code>palmerpenguins</code>. La
librería <code>palmerpenguins</code> será de utilidad para obtenrer la
base de datos con la cual trabajaremos en esta sección.</p>
<!-- Por ejemplo, a veces queremos conjuntos de datos en los que tenemos una fila por medición. Otras veces queremos un marco de datos donde cada tipo de medición tiene su propia columna, y las filas son en cambio grupos más agregados (por ejemplo, un período de tiempo, una unidad experimental como una parcela o un número de lote). Pasar de un formato a otro no es trivial, y tidyr le ofrece herramientas para esto y para una manipulación de datos más sofisticada. -->
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspeccionando la data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(penguins)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(penguins)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizando datos</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(penguins)</span></code></pre></div>
<p>Las funciones más comunes de <code>dplyr</code> son:</p>
<ul>
<li><p><code>select()</code>: selección de columnas</p></li>
<li><p><code>filter()</code>: selección de filas que cumplen una
condición</p></li>
<li><p><code>mutate()</code>: Crea nuevas columnas usando información de
otras</p></li>
<li><p><code>group_by()</code> y <code>summarize()</code>: Obtiene
estadísticos descriptivos en función a datos agrupados</p></li>
<li><p><code>arrange()</code>: Ordena los resultados</p></li>
<li><p><code>count()</code>: Cuenta valores discretos</p></li>
</ul>
</div>
<div id="seleccionar-filas-y-columnas" class="section level2">
<h2>Seleccionar filas y columnas</h2>
<p>Para seleccionar columnas de una base de datos usaremos la función
<code>select()</code>. El primer argumento de la función es la base de
datos (<code>penguins</code>) y el segundo, las columnas que se desea
mantener.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Formato:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># select(dataframe, columnas)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(penguins, island, species, body_mass_g)</span></code></pre></div>
<p>Para seleccionar todas las variables del objeto <code>penguins</code>
- excluyendo las variables <code>year</code> y <code>species</code> -
coloca el signo <code>-</code> delante de cada una de ellas.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(penguins, <span class="sc">-</span>year, <span class="sc">-</span>species)</span></code></pre></div>
</div>
<div id="tuberías-o-pipelines" class="section level2">
<h2>Tuberías o pipelines</h2>
<p>¿Que sucede si deseamos seleccionar y filtrar datos en una misma
línea de código? Existen tres formas de hacerlo. Usar pasos intermedios,
funciones anidadas o tuberias (pipes).</p>
<p>Al usar pasos intermedios lo que se hace es crear un archivo temporal
y usarlo como “input” en la siguiente función:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos un archivo temporal</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>penguins2 <span class="ot">&lt;-</span> <span class="fu">filter</span>(penguins, body_mass_g <span class="sc">&lt;</span> <span class="dv">3000</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Usamos el archivo temporal para seleccionar columnas</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>penguins_sml <span class="ot">&lt;-</span> <span class="fu">select</span>(penguins2, species, sex, body_mass_g)</span></code></pre></div>
<p>Esta forma es legible pero puedes crear muchos objetos temporales en
tu espacio de trabajo que en futuro se te hará complicado hacer el
seguimiento de los objetos de interés. Otra forma de hacer el proceso
anterior es usando funciones anidadas (ej. una función dentro de
otra).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>penguins_sml <span class="ot">&lt;-</span> <span class="fu">select</span>(<span class="fu">filter</span>(penguins, body_mass_g <span class="sc">&lt;</span> <span class="dv">3000</span>), species, sex, body_mass_g)</span></code></pre></div>
<p>Esta forma es mucho útil que la anterior pero puede ser difícil de
entender si se usan muchas funciones anidades.</p>
<p>La última opción, tuberias o pipes, son las usadas más recientemente.
Los pipes te permite tomar el resultado de una función y enviarla
directamente a la siguiente operación. Esto resulta útil cuando
necesitas hacer muchos procesos a la vez en una misma base de datos. Los
pipes en R esta representado por el simbolo <code>%&gt;%</code> y son
extraídos de la paquetería <code>magrittr</code>, instalada
automaticamente con <code>dplyr</code>. El símbolo de pipe puede ser
rápidamente escrita usando los atajos del teclado <code>ctrl</code> +
<code>shift</code> + <code>M</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(body_mass_g <span class="sc">&lt;</span> <span class="dv">3000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(species, sex, body_mass_g)</span></code></pre></div>
<p>En el código anterior los procesos que se realizaron fueron los
siguientes: 1) Primero se filtra todas las variables en donde los
pinguinos hayan registrado un peso menor a 3000g
(<code>body_mass_g</code> &lt; 3000). 2) Segundo, através del operador
pipe (<code>%&gt;%</code>), le decimos a R que del sub-conjunto de datos
resultante seleccione únicamente las variables <code>sex</code> y
<code>body_mass_g</code>.</p>
<p>Si deseamos crear un nuevo objeto usando pipes simplemente asignamos
un nuevo nombre al objeto:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>penguins_sml <span class="ot">&lt;-</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  penguins <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(body_mass_g <span class="sc">&lt;</span> <span class="dv">3000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(species, sex, body_mass_g)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>penguins_sml</span></code></pre></div>
</div>
<div id="crear-nuevas-variables" class="section level2">
<h2>Crear nuevas variables</h2>
<p>Durante el análisis de datos frecuentemente se deseará incorporar
nuevas columnas en el objeto de interés. Por ejemplo, para hacer
conversión de unidades o encontrar la proporción de valores en dos
columnas. La función <code>mutate()</code> te permite hacer estos
procesos. Por ejemplo:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversión de unidades</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">body_mass_kg =</span> body_mass_g<span class="sc">/</span><span class="dv">1000</span>)</span></code></pre></div>
<p>También podemos crear otra columna basada en la primera dentro de la
misma función <code>mutate()</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos dos columnas</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">body_mass_kg =</span> body_mass_g<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">body_mass_lb =</span> body_mass_kg <span class="sc">*</span> <span class="fl">2.2</span>)</span></code></pre></div>
<p>La función <code>head()</code> también funciona con las tuberías
(<code>%&gt;%</code>)</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">body_mass_kg =</span> body_mass_g <span class="sc">/</span> <span class="dv">1000</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">body_mass_lb =</span> body_mass_kg <span class="sc">*</span> <span class="fl">2.2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<p>Si una base de datos presenta valores “NA”, podemos removerlos usando
la función <code>filter()</code> en conjunto con la función
<code>is.na()</code> y el operador <code>!</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(body_mass_g)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">body_mass_kg =</span> body_mass_g <span class="sc">/</span> <span class="dv">1000</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">body_mass_lb =</span> body_mass_kg <span class="sc">*</span> <span class="fl">2.2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<p>La función <code>is.na()</code> determina si en la base de datos
existen valores <code>NA</code>. El símbolo <code>!</code> actúa como
negación. En otras palabras, estamos consultando a R si existen filas en
donde la variable <code>body_mass_g</code> no tienen valores
<code>NA</code></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># EJERCICIO</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Crea una base de datos a partir de penguins que cumpla con los siguientes criterios:</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. La nueva base de datos debe contener solamente la columna species y una nueva llamada flipper_length_cm </span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#    que contiene la longitud de las aletas de los pinguinos (actualmente en milímetros) en centímetros.</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. En la variable flipper_length_cm no deben haber valores NA y deben ser menores a 20 cm.</span></span></code></pre></div>
</div>
<div id="resumir-operaciones" class="section level2">
<h2>Resumir operaciones</h2>
<p>Muchas tareas en los análisis de datos pueden abordarse dividiéndola
en pequeños grupos, aplicar algunos análisis a cada uno de estos y luego
combinar los resultados en una sóla base de datos. Las principales
funciones de <code>dplyr</code> para estos procesos son
<code>group_by()</code> y <code>summarise()</code>. Las funciones
<code>group_by()</code> y <code>summarise()</code> son frecuentemente
utilizadas en conjunto de la siguiente manera:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_body_mass_g =</span> <span class="fu">mean</span>(body_mass_g))</span></code></pre></div>
<p>Dentro de la función <code>group_by()</code> se puede agrupar
múltiples columnas, por ejemplo:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_body_mass_g =</span> <span class="fu">mean</span>(body_mass_g))</span></code></pre></div>
<p>Un aspecto a tener en cuentra durante estos análisis son los valores
<code>NA</code>. Como observamos en los resultados anteriores, la
presencia de valores <code>NA</code> no permite que la operación
indicada sea llevada a cabo. Por tanto, debemos removerla u omitirla.
Para este fin, agregamos dentro de la función <code>mean()</code> el
argumento <code>na.rm = TRUE</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_body_mass_g =</span> <span class="fu">mean</span>(body_mass_g, <span class="at">na.rm =</span> T))</span></code></pre></div>
<p>De la misma forma que en la función <code>group_by()</code>, en
<code>summarise()</code> se pueden agregar múltiples operaciones.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Promedio</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_body_mass_g =</span> <span class="fu">mean</span>(body_mass_g, <span class="at">na.rm =</span> T),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># El valor mínimo por grupo</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_body_mass_g =</span> <span class="fu">min</span>(body_mass_g, <span class="at">na.rm =</span> T),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total de observaciones por grupo</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_cases =</span> <span class="fu">n</span>())</span></code></pre></div>
<p>En ocasiones resulta útil reordenar los resultados para inspeccionar
los valores de acuerdo a un patrón establecido. Por ejemplo, si deseamos
ordenar los pesos de los pinguinos (<code>body_mass_g</code>) de menor a
mayor haremos lo siguiente:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_body_mass_g =</span> <span class="fu">mean</span>(body_mass_g, <span class="at">na.rm =</span> T),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_body_mass_g =</span> <span class="fu">min</span>(body_mass_g, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(min_body_mass_g)</span></code></pre></div>
</div>
<div id="contar-observaciones" class="section level2">
<h2>Contar observaciones</h2>
<p>Al trabajar con datos, a menudo queremos conocer el número de
observaciones para cada variable o combinación de variables. Para esta
tarea, <code>dplyr</code> proporciona la función <code>count()</code>.
Por ejemplo, si quisiéramos contar el número de filas de datos para cada
sexo, haríamos:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sex)</span></code></pre></div>
<p>La función <code>count()</code> es una abreviación de lo que ya hemos
visto: agrupar una variable y ejecutar una operación. En otras palabras
<code>penguins %&gt;% count()</code> es equivalente a:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code></pre></div>
<p>Para nuestra conveniencia, la función <code>count()</code> incluye un
argumento que ordena los elementos de la variable de interés
(<code>sort</code>).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cuenta el total de observaciones de la variable sexo</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sex, <span class="at">sort =</span> T)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Cuenta el total de observaciones en la variable sexo y especie</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sex, species)</span></code></pre></div>
<p>Con el código anterior, podemos usar la función
<code>arrange()</code> para ordenar la tabla según una serie de
criterios. Por ejemplo, podríamos ordenar la tabla anterior en (i) un
orden alfabético de los niveles de las especies y (ii) en orden
descendente del recuento:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sex, species) <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(species, <span class="fu">desc</span>(n))</span></code></pre></div>
<p>De la tabla anterior podemos observar que existen 6 observaciones de
la especie Adelie y 5 de la especie Gentoo que no han sido especificados
su sexo (ej. NA)</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejercicios</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. ¿Cuántos pinguinos se registran por isla?</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Usa group_by() y summarise() para encontrar la media, y la longitud mínima y máxima del pico de cada especie. </span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrega también el número de observaciones.</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. ¿Cual es el animal más pesado en cada año? </span></span></code></pre></div>
</div>
<div id="reordenar-datos" class="section level2">
<h2>Reordenar datos</h2>
<p>Anteriormente discutimos sobre cómo estructurar nuestros datos, lo
que nos llevó a los cuatro principios que definen un conjunto de datos
ordenado:</p>
<pre><code>- Cada variable tiene su propia columna

- Cada observación tiene su propia fila

- Cada valor debe tener su propia celda
  
- Cada tipo de unidad de unidad de observación forma una tabla.</code></pre>
<p>En el objeto <code>penguins</code>, las filas contienen valores de
las variables asociadas en cada registro (la unidad), valores asociados
a las variables <code>body_mass_g</code> o <code>sex</code> de cada
animal se encuentran asociadas con cada registro. Que pasaría si en
lugar de comparar registros, deseamos comparar los diferentes promedios
de <code>body_mass_g</code> de cada <code>sex</code> entre
<code>island</code>.</p>
<p>Tendríamos que crear una nueva tabla en la que cada fila (la unidad)
estuviera compuesta por los valores de las variables asociadas a cada
isla. En términos prácticos, esto significa que los valores del sexo se
convertirían en los nombres de las variables de la columna y las celdas
contendrían los valores de la media de body_mass_g observada en cada
isla.</p>
<p>Una vez creada la nueva tabla, resulta sencillo explorar la relación
entre la <code>body_mass_g</code> de los distintos pingüinos dentro de
las <code>island</code> y entre ellas. El punto clave aquí es que
seguimos una estructura de datos ordenada, pero hemos reformado los
datos según las observaciones de interés: masa <code>body_mass_g</code>
por <code>island</code> en lugar de registros por fecha.</p>
<p>La transformación opuesta sería transformar los nombres de las
columnas en valores de una variable.</p>
<p>Podemos hacer estas dos transformaciones con dos funciones de la
paquetería <code>tidyr</code>, <code>pivot_wider()</code> y
<code>pivot_longer()</code>.</p>
<p>Pueden parecer diseños de datos muy diferentes, pero hay algunas
herramientas que hacen que las transiciones entre estos diseños sean más
sencillas de lo que se piensa. El siguiente gif muestra cómo se
relacionan estos dos formatos, y le da una idea de cómo podemos utilizar
R para cambiar de un formato a otro</p>
<div id="datos-largos" class="section level3">
<h3>Datos largos</h3>
<p>Un problema común es cuando en una base de datos los nombres de las
columnas no representan nombres de variables, sino que representan los
valores de una variable. Para ejemplificar veamos la siguiente base de
datos. Tomando el caso del objeto <code>tabla4a</code>: los nombres de
las columnas 1999 y 2000 representan valores de la variable</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargemos la paquetería</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datos)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>tabla4a</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   pais       `1999` `2000`
##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;
## 1 Afganistán    745   2666
## 2 Brasil      37737  80488
## 3 China      212258 213766</code></pre>
<p>Tomando el caso de la tabla4a: los nombres de las columnas 1999 y
2000 representan los valores de la variable año, los valores en las
columnas 1999 y 2000 representan valores de la variable casos y cada
fila representa dos observaciones en lugar de una.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>penguins_gw <span class="ot">&lt;-</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  penguins <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(body_mass_g)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(island, sex) <span class="sc">%&gt;%</span> </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_body_mass_g =</span> <span class="fu">mean</span>(body_mass_g))</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(penguins_gw)</span></code></pre></div>
<pre><code>## Rows: 9
## Columns: 3
## Groups: island [3]
## $ island           &lt;fct&gt; Biscoe, Biscoe, Biscoe, Dream, Dream, Dream,…
## $ sex              &lt;fct&gt; female, male, NA, female, male, NA, female, …
## $ mean_body_mass_g &lt;dbl&gt; 4319.375, 5104.518, 4587.500, 3446.311, 3987…</code></pre>
</div>
</div>
<div id="exportando-datos" class="section level2">
<h2>Exportando datos</h2>
<p>Ahora que hemos aprendido a usar <code>dplyr</code> para extraer
información, es necesario conocer como exportar estos nuevos set de
datos para compartirlos con los colegas.</p>
<p>De la misma forma en que usamos la función <code>read_csv()</code>
para importar los datos, existe una función denominada
<code>write_csv()</code> que genera un archivo en formato csv de tus
nuevo set de datos</p>
<p>Antes de usar <code>write_csv()</code>, crearemos una carpeta,
<code>data</code>, en nuestro directorio de trabajo en donde se
almacerán los datos creados. No deseamos escribir el mismo conjunto de
datos en el mismo directorio donde se encuentra nuestra base de datos
original. Una buena práctica es separarla. Los datos originales no deben
ser modificados y deben estar aislados para evitar modificarlos o
eliminarlos.</p>
<p>Como preparación para nuestra próxima lección sobre visualización,
vamos a preparar una versión depurada del conjunto de datos que no
incluya ningún dato que falte. Empezamos removiendo las observaciones de
pinguinos que tengan valores <code>NA</code>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solo registros completos</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>penguins_complete <span class="ot">&lt;-</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  penguins <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>penguins_raw_complete <span class="ot">&lt;-</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  penguins_raw <span class="sc">%&gt;%</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span></code></pre></div>
<p>Para asegurarnos que todos tengamos el mismo sub-conjunto de datos,
revisemos las dimensiones de los objetos <code>penguins_complete</code>
y <code>penguins_raw_complete</code> usando <code>dim()</code>.</p>
<p>Ahora que nuestro set de datos esta listo procedamos a guardarlo en
formato CSV dentro de la carpeta <code>data</code></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(penguins, <span class="at">file =</span> <span class="st">&quot;data/penguins_complete.csv&quot;</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(penguins, <span class="at">file =</span> <span class="st">&quot;data/penguins_raw_complete.csv&quot;</span>)</span></code></pre></div>
<p>Ahora en nuestra carpeta <code>data</code> tendremos los dos
sub-conjunto de datos previamente procesados. Pruebe importando estos
nuevos archivos dentro de R y explore los datos con la función
<code>str()</code>. Puede también usar la función <code>glimpse()</code>
¿Qué observa?</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5,h6",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
